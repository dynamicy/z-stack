///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V7.51A/W32 for 8051               08/Jun/2010  11:05:19 /
// Copyright 2004-2009 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//    Source file        =  D:\µ{¦¡¶}µo\TI Zigbee Z-Stack\ZStack-CC2530-2.3.0 /
//                          -1.4.0\ZStack-CC2530-2.3.0-1.4.0\Components\mt\MT /
//                          _NWK.c                                            /
//    Command line       =  -f "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\Tools\CC2530DB\f8wRouter.cfg"   /
//                          (-DCPU32MHZ -DROOT=__near_func                    /
//                          -DMAC_CFG_APP_PENDING_QUEUE=TRUE -DRTR_NWK        /
//                          -DBLINK_LEDS) -f "D:\µ{¦¡¶}µo\TI Zigbee           /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg"   /
//                          (-DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR     /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          "-DCONST=const __code" -DGENERIC=__generic        /
//                          -DRFD_RCVC_ALWAYS_ON=TRUE -DPOLL_RATE=1000        /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)  /
//                          -DREJOIN_POLL_RATE=440 "D:\µ{¦¡¶}µo\TI Zigbee     /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Components\mt\MT_NWK.c" -D RouterKB    /
//                          -D Location -D ZTOOL_P1 -D MT_TASK -D             /
//                          MT_SYS_FUNC -D MT_ZDO_FUNC -D                     /
//                          LCD_SUPPORTED=DEBUG -lC "D:\µ{¦¡¶}µo\TI Zigbee    /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\RouterKB\List\" -lA "D:\µ{¦¡¶}µo\TI      /
//                          Zigbee Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-C /
//                          C2530-2.3.0-1.4.0\Projects\zstack\Utilities\Locat /
//                          ionApp\CC2530DB\RouterKB\List\" --diag_suppress   /
//                          Pe001,Pa010 -o "D:\µ{¦¡¶}µo\TI Zigbee             /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\RouterKB\Obj\" -e --require_prototypes   /
//                          --debug --core=plain --dptr=16,1                  /
//                          --data_model=large --code_model=banked            /
//                          --calling_convention=xdata_reentrant              /
//                          --place_constants=data_rom --nr_virtual_regs 16   /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\" -I "D:\µ{¦¡¶}µo\TI Zigbee              /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\SOURCE\" -I "D:\µ{¦¡¶}µo\TI Zigbee    /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\ZMAIN\TI2530DB\" -I             /
//                          "D:\µ{¦¡¶}µo\TI Zigbee Z-Stack\ZStack-CC2530-2.3. /
//                          0-1.4.0\ZStack-CC2530-2.3.0-1.4.0\Projects\zstack /
//                          \Utilities\LocationApp\CC2530DB\..\..\..\..\..\CO /
//                          MPONENTS\MT\" -I "D:\µ{¦¡¶}µo\TI Zigbee           /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\HAL\INCLUDE\"  /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\HAL\TARGET\CC2 /
//                          530EB\" -I "D:\µ{¦¡¶}µo\TI Zigbee                 /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\OSAL\MCU\CCSOC /
//                          \" -I "D:\µ{¦¡¶}µo\TI Zigbee                      /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\OSAL\INCLUDE\" /
//                           -I "D:\µ{¦¡¶}µo\TI Zigbee                        /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\STACK\AF\" -I  /
//                          "D:\µ{¦¡¶}µo\TI Zigbee Z-Stack\ZStack-CC2530-2.3. /
//                          0-1.4.0\ZStack-CC2530-2.3.0-1.4.0\Projects\zstack /
//                          \Utilities\LocationApp\CC2530DB\..\..\..\..\..\CO /
//                          MPONENTS\STACK\NWK\" -I "D:\µ{¦¡¶}µo\TI Zigbee    /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\STACK\SEC\"    /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\STACK\SAPI\"   /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\STACK\SYS\"    /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\STACK\ZDO\"    /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\ZMAC\F8W\" -I  /
//                          "D:\µ{¦¡¶}µo\TI Zigbee Z-Stack\ZStack-CC2530-2.3. /
//                          0-1.4.0\ZStack-CC2530-2.3.0-1.4.0\Projects\zstack /
//                          \Utilities\LocationApp\CC2530DB\..\..\..\..\..\CO /
//                          MPONENTS\ZMAC\" -I "D:\µ{¦¡¶}µo\TI Zigbee         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\SERVICES\SADDR /
//                          \" -I "D:\µ{¦¡¶}µo\TI Zigbee                      /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\SERVICES\SDATA /
//                          \" -I "D:\µ{¦¡¶}µo\TI Zigbee                      /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\MAC\INCLUDE\"  /
//                          -I "D:\µ{¦¡¶}µo\TI Zigbee                         /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\MAC\HIGH_LEVEL /
//                          \" -I "D:\µ{¦¡¶}µo\TI Zigbee                      /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\ /
//                          srf04\" -I "D:\µ{¦¡¶}µo\TI Zigbee                 /
//                          Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2 /
//                          .3.0-1.4.0\Projects\zstack\Utilities\LocationApp\ /
//                          CC2530DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\ /
//                          srf04\SINGLE_CHIP\" -I "C:\IAR Systems\Embedded   /
//                          Workbench 5.3\8051\INC\" -I "C:\IAR               /
//                          Systems\Embedded Workbench 5.3\8051\INC\CLIB\"    /
//                          -Ohz                                              /
//    List file          =  D:\µ{¦¡¶}µo\TI Zigbee Z-Stack\ZStack-CC2530-2.3.0 /
//                          -1.4.0\ZStack-CC2530-2.3.0-1.4.0\Projects\zstack\ /
//                          Utilities\LocationApp\CC2530DB\RouterKB\List\MT_N /
//                          WK.s51                                            /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME MT_NWK

        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN __INIT_XDATA_Z

        PUBLIC _nwkCallbackSub
// D:\µ{¦¡¶}µo\TI Zigbee Z-Stack\ZStack-CC2530-2.3.0-1.4.0\ZStack-CC2530-2.3.0-1.4.0\Components\mt\MT_NWK.c
//    1 /**************************************************************************************************
//    2   Filename:       MT_NWK.c
//    3   Revised:        $Date: 2009-08-26 14:17:16 -0700 (Wed, 26 Aug 2009) $
//    4   Revision:       $Revision: 20661 $
//    5 
//    6 
//    7     Description:    MonitorTest functions for the NWK layer.
//    8 
//    9     Copyright 2007-2009 Texas Instruments Incorporated. All rights reserved.
//   10 
//   11     IMPORTANT: Your use of this Software is limited to those specific rights
//   12     granted under the terms of a software license agreement between the user
//   13     who downloaded the software, his/her employer (which must be your employer)
//   14     and Texas Instruments Incorporated (the "License").  You may not use this
//   15     Software unless you agree to abide by the terms of the License. The License
//   16     limits your use, and you acknowledge, that the Software may not be modified,
//   17     copied or distributed unless embedded on a Texas Instruments microcontroller
//   18     or used solely and exclusively in conjunction with a Texas Instruments radio
//   19     frequency transceiver, which is integrated into your product.  Other than for
//   20     the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   21     works of, modify, distribute, perform, display or sell this Software and/or
//   22     its documentation for any purpose.
//   23 
//   24     YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   25     PROVIDED “AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
//   26     INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
//   27     NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   28     TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   29     NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   30     LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   31     INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   32     OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   33     OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   34     (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   35 
//   36     Should you have any questions regarding your right to use this Software,
//   37     contact Texas Instruments Incorporated at www.TI.com.
//   38 
//   39 **************************************************************************************************/
//   40 
//   41 /***************************************************************************************************
//   42  * INCLUDES
//   43  ***************************************************************************************************/
//   44 #include "ZComDef.h"
//   45 #include "MT.h"
//   46 #include "MT_NWK.h"
//   47 #include "NLMEDE.h"
//   48 #include "nwk.h"
//   49 #include "nwk_globals.h"
//   50 #include "nwk_util.h"
//   51 #include "OSAL.h"
//   52 #include "ZDApp.h"
//   53 
//   54 #if !defined( WIN32 )
//   55   #include "OnBoard.h"
//   56 #endif
//   57 
//   58 
//   59 /* HAL */
//   60 #include "hal_lcd.h"
//   61 /***************************************************************************************************
//   62  * GLOBAL VARIABLES
//   63  ***************************************************************************************************/

        RSEG XDATA_Z:XDATA:NOROOT(0)
//   64 uint16 _nwkCallbackSub;
_nwkCallbackSub:
        DS 2
        REQUIRE __INIT_XDATA_Z

        END
//   65 
//   66 /*********************************************************************
//   67  * TYPEDEFS
//   68  */
//   69 
//   70 /***************************************************************************************************
//   71  * LOCAL FUNCTIONS
//   72  ***************************************************************************************************/
//   73 #if defined (MT_NWK_FUNC)
//   74 void MT_NldeDataRequest(uint8 *pBuf);
//   75 void MT_NlmeNetworkFormationRequest(uint8 *pBuf);
//   76 void MT_NlmePermitJoiningRequest(uint8 *pBuf);
//   77 void MT_NlmeStartRouterRequest(uint8 *pBuf);
//   78 void MT_NlmeJoinRequest(uint8 *pBuf);
//   79 void MT_NlmeLeaveRequest(uint8 *pBuf);
//   80 void MT_NlmeResetRequest(uint8 *pBuf);
//   81 void MT_NlmeGetRequest(uint8 *pBuf);
//   82 void MT_NlmeSetRequest(uint8 *pBuf);
//   83 void MT_NlmeNetworkDiscoveryRequest(uint8 *pBuf);
//   84 void MT_NlmeRouteDiscoveryRequest(uint8 *pBuf);
//   85 void MT_NlmeDirectJoinRequest(uint8 *pBuf);
//   86 void MT_NlmeOrphanJoinRequest(uint8 *pBuf);
//   87 
//   88 uint8 MT_Nwk_DataRequest( uint16 dstAddr, uint8 nsduLen, uint8* nsdu,
//   89                          uint8 nsduHandle, uint16 nsduHandleOptions,
//   90                          uint8 secure, uint8 discoverRoute,
//   91                          uint8 radius);
//   92 #endif /* MT_NWK_FUNC */
//   93 
//   94 #if defined (MT_NWK_FUNC)
//   95 /***************************************************************************************************
//   96  * @fn      MT_NwkCommandProcessing
//   97  *
//   98  * @brief
//   99  *
//  100  *   Process all the NWK commands that are issued by test tool
//  101  *
//  102  * @param   cmd_id - Command ID
//  103  * @param   len    - Length of received SPI data message
//  104  * @param   pData  - pointer to received SPI data message
//  105  *
//  106  * @return  status
//  107  ***************************************************************************************************/
//  108 uint8 MT_NwkCommandProcessing(uint8 *pBuf)
//  109 {
//  110   uint8 status = MT_RPC_SUCCESS;
//  111 
//  112   switch (pBuf[MT_RPC_POS_CMD1])
//  113   {
//  114     case MT_NWK_INIT:
//  115       nwk_init(NWK_TaskID);
//  116       break;
//  117 
//  118     case MT_NLDE_DATA_REQ:
//  119       MT_NldeDataRequest(pBuf);
//  120       break;
//  121 
//  122     case MT_NLME_NETWORK_FORMATION_REQ:
//  123       MT_NlmeNetworkFormationRequest(pBuf);
//  124       break;
//  125 
//  126     case MT_NLME_PERMIT_JOINING_REQ:
//  127        MT_NlmePermitJoiningRequest(pBuf);
//  128       break;
//  129 
//  130      case MT_NLME_JOIN_REQ:
//  131        MT_NlmeJoinRequest(pBuf);
//  132        break;
//  133 
//  134      case MT_NLME_LEAVE_REQ:
//  135        MT_NlmeLeaveRequest(pBuf);
//  136        break;
//  137 
//  138      case MT_NLME_RESET_REQ:
//  139        MT_NlmeResetRequest(pBuf);
//  140        break;
//  141 
//  142      case MT_NLME_GET_REQ:
//  143        MT_NlmeGetRequest(pBuf);
//  144        break;
//  145 
//  146      case MT_NLME_SET_REQ:
//  147        MT_NlmeSetRequest(pBuf);
//  148        break;
//  149 
//  150      case MT_NLME_NETWORK_DISCOVERY_REQ:
//  151        MT_NlmeNetworkDiscoveryRequest(pBuf);
//  152        break;
//  153 
//  154      case MT_NLME_ROUTE_DISCOVERY_REQ:
//  155        MT_NlmeRouteDiscoveryRequest(pBuf);
//  156        break;
//  157 
//  158      case MT_NLME_DIRECT_JOIN_REQ:
//  159        MT_NlmeDirectJoinRequest(pBuf);
//  160        break;
//  161 
//  162      case MT_NLME_ORPHAN_JOIN_REQ:
//  163        MT_NlmeOrphanJoinRequest(pBuf);
//  164        break;
//  165 
//  166     case MT_NLME_START_ROUTER_REQ:
//  167       MT_NlmeStartRouterRequest(pBuf);
//  168       break;
//  169 
//  170     default:
//  171       status = MT_RPC_ERR_COMMAND_ID;
//  172       break;
//  173   }
//  174 
//  175   return status;
//  176 }
//  177 
//  178 /***************************************************************************************************
//  179  * @fn      MT_NldeDataReq
//  180  *
//  181  * @brief   Process NLDE Data Request commands
//  182  *
//  183  * @param   pBuf - pointer to received buffer
//  184  *
//  185  * @return  void
//  186  ***************************************************************************************************/
//  187 void MT_NldeDataRequest(uint8 *pBuf)
//  188 {
//  189   uint8 retValue = ZFailure;
//  190   uint16 dstAddr;
//  191   uint8 dataLen = 0;
//  192   uint8 *dataPtr;
//  193   uint8 cmdId;
//  194 
//  195   /* parse header */
//  196   cmdId = pBuf[MT_RPC_POS_CMD1];
//  197   pBuf += MT_RPC_FRAME_HDR_SZ;
//  198 
//  199   /* First read the DstAddr */
//  200   dstAddr = BUILD_UINT16( pBuf[0], pBuf[1] );
//  201   pBuf += sizeof( dstAddr );
//  202 
//  203   /* Get the NSDU details */
//  204   dataLen = *pBuf++;
//  205   dataPtr = pBuf;
//  206 
//  207   /* Skip a length of ZTEST_DEFAULT_DATA_LEN */
//  208   pBuf += ZTEST_DEFAULT_DATA_LEN;
//  209 
//  210   /* Send out Data Request */
//  211   retValue = MT_Nwk_DataRequest(dstAddr, dataLen, dataPtr, pBuf[0], BUILD_UINT16(pBuf[1], pBuf[2]),
//  212                                 pBuf[3], pBuf[4], pBuf[5]);
//  213 
//  214   /* Build and send back the response */
//  215   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  216 }
//  217 
//  218 
//  219 /***************************************************************************************************
//  220  * @fn      MT_NlmeNetworkFormationRequest
//  221  *
//  222  * @brief   Network Formation Request
//  223  *
//  224  * @param   pBuf - pointer to the received buffer
//  225  *
//  226  * @return  void
//  227  ***************************************************************************************************/
//  228 void MT_NlmeNetworkFormationRequest(uint8 *pBuf)
//  229 {
//  230   uint8 retValue = ZFailure;
//  231 	uint16 panId;
//  232   uint32 channelList;
//  233   uint8 cmdId;
//  234 
//  235   /* parse header */
//  236   cmdId = pBuf[MT_RPC_POS_CMD1];
//  237   pBuf += MT_RPC_FRAME_HDR_SZ;
//  238 
//  239   /* Build panId */
//  240   panId = BUILD_UINT16( pBuf[0], pBuf[1]);
//  241   pBuf += sizeof(uint16);
//  242 			
//  243   /* Build the channel list */
//  244   channelList = osal_build_uint32(pBuf, 4);
//  245   pBuf += sizeof(uint32);
//  246 
//  247   if ( ZG_BUILD_COORDINATOR_TYPE && ZG_DEVICE_COORDINATOR_TYPE )
//  248   {
//  249     retValue = NLME_NetworkFormationRequest( panId, NULL, channelList, pBuf[0], pBuf[1], pBuf[2], pBuf[3] );
//  250   }
//  251   else
//  252   {
//  253     retValue = ZUnsupportedMode;
//  254   }
//  255 
//  256   /* Build and send back the response */
//  257   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  258 }
//  259 
//  260 /***************************************************************************************************
//  261  * @fn      MT_NlmePermitJoiningRequest
//  262  *
//  263  * @brief   Permit Joining Request
//  264  *
//  265  * @param   pBuf - pointer to the received buffer
//  266  *
//  267  * @return  void
//  268  ***************************************************************************************************/
//  269 void MT_NlmePermitJoiningRequest(uint8 *pBuf)
//  270 {
//  271   uint8 retValue = ZFailure;
//  272   uint8 cmdId;
//  273 
//  274   /* parse header */
//  275   cmdId = pBuf[MT_RPC_POS_CMD1];
//  276   pBuf += MT_RPC_FRAME_HDR_SZ;
//  277 
//  278   if (ZSTACK_ROUTER_BUILD)
//  279   {
//  280     retValue = NLME_PermitJoiningRequest(*pBuf);
//  281   }
//  282   else
//  283   {
//  284     retValue = ZUnsupportedMode;
//  285   }
//  286 
//  287   /* Build and send back the response */
//  288   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  289 }
//  290 
//  291 /***************************************************************************************************
//  292  * @fn      MT_NlmeStartRouterRequest
//  293  *
//  294  * @brief   Start Router Request
//  295  *
//  296  * @param   pBuf - pointer to the received buffer
//  297  *
//  298  * @return  void
//  299  ***************************************************************************************************/
//  300 void MT_NlmeStartRouterRequest(uint8 *pBuf)
//  301 {
//  302   uint8 retValue = ZFailure;
//  303   uint8 cmdId;
//  304 
//  305   /* parse header */
//  306   cmdId = pBuf[MT_RPC_POS_CMD1];
//  307   pBuf += MT_RPC_FRAME_HDR_SZ;
//  308 
//  309   if ( ZSTACK_ROUTER_BUILD )
//  310   {
//  311     retValue = (uint8)NLME_StartRouterRequest(pBuf[0], pBuf[1], pBuf[2]);
//  312   }
//  313   else
//  314   {
//  315     retValue = ZUnsupportedMode;
//  316   }
//  317 
//  318   /* Build and send back the response */
//  319   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  320 }
//  321 
//  322 /***************************************************************************************************
//  323  * @fn      MT_NlmeJoinRequest
//  324  *
//  325  * @brief   Join Request
//  326  *
//  327  * @param   pBuf - pointer to the received buffer
//  328  *
//  329  * @return  void
//  330  ***************************************************************************************************/
//  331 void MT_NlmeJoinRequest(uint8 *pBuf)
//  332 {
//  333   uint8 retValue = ZFailure;
//  334   uint8 dummyExPANID[Z_EXTADDR_LEN] = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF};
//  335   uint8 cmdId;
//  336 
//  337   /* parse header */
//  338   cmdId = pBuf[MT_RPC_POS_CMD1];
//  339   pBuf += MT_RPC_FRAME_HDR_SZ;
//  340 
//  341 	retValue = NLME_JoinRequest(dummyExPANID, BUILD_UINT16(pBuf[0], pBuf[1]), pBuf[2], pBuf[3]);
//  342 
//  343   if ( pBuf[6] & CAPINFO_RCVR_ON_IDLE )
//  344   {
//  345     /* The receiver is on, turn network layer polling off. */
//  346     NLME_SetPollRate( 0 );
//  347     NLME_SetQueuedPollRate( 0 );
//  348     NLME_SetResponseRate( 0 );
//  349   }
//  350 
//  351   /* Build and send back the response */
//  352   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  353 }
//  354 
//  355 /***************************************************************************************************
//  356  * @fn      MT_NlmeLeaveRequest
//  357  *
//  358  * @brief   Leave Request
//  359  *
//  360  * @param   pBuf - pointer to the received buffer
//  361  *
//  362  * @return  void
//  363  ***************************************************************************************************/
//  364 void MT_NlmeLeaveRequest(uint8 *pBuf)
//  365 {
//  366   NLME_LeaveReq_t req;
//  367   uint8 retValue = ZFailure;
//  368   uint8 index, cmdId;
//  369 
//  370   /* parse header */
//  371   cmdId = pBuf[MT_RPC_POS_CMD1];
//  372   pBuf += MT_RPC_FRAME_HDR_SZ;
//  373 
//  374   /* If extAddr is all zeros, it means null pointer */
//  375   for(index=0;((index < Z_EXTADDR_LEN) && (pBuf[index] == 0));index++);
//  376 
//  377   if (index == Z_EXTADDR_LEN)
//  378   {
//  379     req.extAddr = NULL;
//  380   }
//  381   else
//  382   {
//  383     req.extAddr = pBuf;
//  384   }
//  385 
//  386   /* Increment the pointer */
//  387   pBuf += Z_EXTADDR_LEN;
//  388 
//  389   req.removeChildren = FALSE;
//  390   req.rejoin         = FALSE;
//  391   req.silent         = FALSE;
//  392 
//  393   retValue = NLME_LeaveReq(&req);
//  394 
//  395   /* Build and send back the response */
//  396   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  397 }
//  398 
//  399 
//  400 /***************************************************************************************************
//  401  * @fn      MT_NlmeResetRequest
//  402  *
//  403  * @brief   Leave Request
//  404  *
//  405  * @param   pBuf - pointer to the received buffer
//  406  *
//  407  * @return  void
//  408  ***************************************************************************************************/
//  409 void MT_NlmeResetRequest(uint8 *pBuf)
//  410 {
//  411   uint8 retValue = NLME_ResetRequest();
//  412 
//  413   /* Build and send back the response */
//  414   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), MT_NLME_RESET_REQ, 1, &retValue);
//  415 }
//  416 
//  417 /***************************************************************************************************
//  418  * @fn      MT_NlmeGetRequest
//  419  *
//  420  * @brief   Get Request
//  421  *
//  422  * @param   pBuf - pointer to the received buffer
//  423  *
//  424  * @return  void
//  425  ***************************************************************************************************/
//  426 void MT_NlmeGetRequest(uint8 *pBuf)
//  427 {
//  428   uint8 dataBuf[11];
//  429   uint8 attr, index, cmdId;
//  430 
//  431   /* parse header */
//  432   cmdId = pBuf[MT_RPC_POS_CMD1];
//  433   pBuf += MT_RPC_FRAME_HDR_SZ;
//  434 
//  435   attr = *pBuf++;
//  436   index = *pBuf;
//  437 
//  438   dataBuf[0] = NLME_GetRequest((ZNwkAttributes_t )attr, index, &dataBuf[1]);
//  439 
//  440   /* Build and send back the response */
//  441   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId,
//  442                                11, dataBuf );
//  443 }
//  444 
//  445 /***************************************************************************************************
//  446  * @fn      MT_NlmeSetRequest
//  447  *
//  448  * @brief   Set Request
//  449  *
//  450  * @param   pBuf - pointer to the received buffer
//  451  *
//  452  * @return  void
//  453  ***************************************************************************************************/
//  454 void MT_NlmeSetRequest(uint8 *pBuf)
//  455 {
//  456   uint8 retValue = ZFailure;
//  457   uint8 cmdId;
//  458 
//  459   /* parse header */
//  460   cmdId = pBuf[MT_RPC_POS_CMD1];
//  461   pBuf += MT_RPC_FRAME_HDR_SZ;
//  462 
//  463   retValue = NLME_SetRequest((ZNwkAttributes_t)pBuf[0], pBuf[1], &pBuf[2]);
//  464 
//  465   /* Update NV */
//  466   ZDApp_NVUpdate();
//  467 
//  468   /* Build and send back the response */
//  469   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue );
//  470 }
//  471 
//  472 /***************************************************************************************************
//  473  * @fn      MT_NlmeNetworkDiscoveryRequest
//  474  *
//  475  * @brief   Network Discovery Request
//  476  *
//  477  * @param   pBuf - pointer to the received buffer
//  478  *
//  479  * @return  void
//  480  ***************************************************************************************************/
//  481 void MT_NlmeNetworkDiscoveryRequest(uint8 *pBuf)
//  482 {
//  483   uint8 retValue = ZFailure;
//  484   uint8 cmdId;
//  485   uint32 scanChannels;
//  486 
//  487   /* parse header */
//  488   cmdId = pBuf[MT_RPC_POS_CMD1];
//  489   pBuf += MT_RPC_FRAME_HDR_SZ;
//  490 
//  491   /* Scan channels */
//  492   scanChannels = osal_build_uint32(pBuf, 4);
//  493   pBuf += sizeof(uint32);
//  494 
//  495   retValue = NLME_NetworkDiscoveryRequest(scanChannels, *pBuf);
//  496 
//  497   /* Build and send back the response */
//  498   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue );
//  499 }
//  500 
//  501 /***************************************************************************************************
//  502  * @fn      MT_NlmeRouteDiscoveryRequest
//  503  *
//  504  * @brief   Route Discovery Request
//  505  *
//  506  * @param   pBuf - pointer to the received buffer
//  507  *
//  508  * @return  void
//  509  ***************************************************************************************************/
//  510 void MT_NlmeRouteDiscoveryRequest(uint8 *pBuf)
//  511 {
//  512   uint8 retValue = ZFailure;
//  513   uint8 cmdId;
//  514 
//  515   /* parse header */
//  516   cmdId = pBuf[MT_RPC_POS_CMD1];
//  517   pBuf += MT_RPC_FRAME_HDR_SZ;
//  518 
//  519   if ( ZSTACK_ROUTER_BUILD )
//  520   {
//  521     retValue = NLME_RouteDiscoveryRequest(BUILD_UINT16(pBuf[0], pBuf[1]), pBuf[2], pBuf[3]);
//  522   }
//  523   else
//  524   {
//  525     retValue = ZUnsupportedMode;
//  526   }
//  527 
//  528   /* Build and send back the response */
//  529   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  530 }
//  531 
//  532 /***************************************************************************************************
//  533  * @fn      MT_NlmeDirectJoinRequest
//  534  *
//  535  * @brief   Direct Join Request
//  536  *
//  537  * @param   pBuf - pointer to the received buffer
//  538  *
//  539  * @return  void
//  540  ***************************************************************************************************/
//  541 void MT_NlmeDirectJoinRequest(uint8 *pBuf)
//  542 {
//  543   uint8 retValue = ZFailure;
//  544   uint8 cmdId;
//  545 
//  546   /* parse header */
//  547   cmdId = pBuf[MT_RPC_POS_CMD1];
//  548   pBuf += MT_RPC_FRAME_HDR_SZ;
//  549 
//  550   if ( ZSTACK_ROUTER_BUILD )
//  551   {
//  552     retValue = NLME_DirectJoinRequest( pBuf, pBuf[8] );
//  553     halLcdDisplayUint8(HAL_LCD_LINE_1, 1, HAL_LCD_RADIX_DEC, retValue);
//  554   }
//  555   else
//  556   {
//  557     retValue = ZUnsupportedMode;
//  558   }
//  559 
//  560   /* Build and send back the response */
//  561   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  562 }
//  563 
//  564 /***************************************************************************************************
//  565  * @fn      MT_NlmeOrphanJoinRequest
//  566  *
//  567  * @brief   Orphan Join Request
//  568  *
//  569  * @param   pBuf - pointer to the received buffer
//  570  *
//  571  * @return  void
//  572  ***************************************************************************************************/
//  573 void MT_NlmeOrphanJoinRequest(uint8 *pBuf)
//  574 {
//  575   uint8 i, j, attr;
//  576   uint8 retValue = ZFailure;
//  577   uint32 channelList;
//  578   uint8 cmdId;
//  579 
//  580   if ( ZSTACK_END_DEVICE_BUILD )
//  581   {
//  582     /* parse header */
//  583     cmdId = pBuf[MT_RPC_POS_CMD1];
//  584     pBuf += MT_RPC_FRAME_HDR_SZ;
//  585 
//  586     /* Channel list bit mask */
//  587     channelList = osal_build_uint32(pBuf, 4);
//  588     pBuf += sizeof(uint32);
//  589 
//  590     /* Count number of channels */
//  591     j = attr = 0;
//  592 
//  593     for (i = 0; i < ED_SCAN_MAXCHANNELS; i++)
//  594     {
//  595       if (channelList & (1 << i))
//  596       {
//  597         j++;
//  598         attr = i;
//  599       }
//  600     }
//  601 
//  602     /* If only one channel specified */
//  603     if (j == 1)
//  604     {
//  605       _NIB.scanDuration = *pBuf;
//  606       _NIB.nwkLogicalChannel = attr;
//  607       _NIB.channelList = channelList;
//  608       if ( !_NIB.CapabilityInfo )
//  609       {
//  610         _NIB.CapabilityInfo = ZDO_Config_Node_Descriptor.CapabilityFlags;
//  611       }
//  612 
//  613       devState = DEV_NWK_ORPHAN;
//  614       retValue = (uint8)NLME_OrphanJoinRequest(channelList, *pBuf);
//  615     }
//  616     else
//  617     {
//  618       retValue = ZNwkInvalidParam;
//  619     }
//  620    }
//  621    else
//  622    {
//  623      retValue = ZUnsupportedMode;
//  624    }
//  625 
//  626   /* Build and send back the response */
//  627   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_SRSP | (uint8)MT_RPC_SYS_NWK), cmdId, 1, &retValue);
//  628 }
//  629 
//  630 /***************************************************************************************************
//  631  * @fn      MT_Nwk_DataRequest
//  632  *
//  633  * @brief   Nwk Data Request
//  634  *
//  635  * @param   dstAddr, nsduLen, nsdu, nsduHandle, nsduHandleOptions, secure, discoverRoute, radius
//  636  *
//  637  * @return  void
//  638  ***************************************************************************************************/
//  639 uint8 MT_Nwk_DataRequest(uint16 dstAddr, uint8 nsduLen, uint8* nsdu,
//  640                          uint8 nsduHandle, uint16 nsduHandleOptions,
//  641                          uint8 secure, uint8 discoverRoute,
//  642                          uint8 radius)
//  643 {
//  644     uint8               status;
//  645     NLDE_DataReqAlloc_t dra;
//  646     NLDE_DataReq_t*     req;
//  647 
//  648 
//  649     dra.overhead = sizeof(NLDE_DataReq_t);
//  650     dra.nsduLen  = nsduLen;
//  651     dra.secure   = secure;
//  652 
//  653     req = NLDE_DataReqAlloc(&dra);
//  654 
//  655     if ( req != NULL )
//  656     {
//  657       osal_memcpy(req->nfd.nsdu, nsdu, nsduLen);
//  658 
//  659       req->nfd.dstAddr           = dstAddr;
//  660       req->nfd.nsduHandleOptions = nsduHandleOptions;
//  661       req->nfd.discoverRoute     = discoverRoute;
//  662       req->nfd.radius            = radius;
//  663 
//  664       status = NLDE_DataReq( req );
//  665     }
//  666     else
//  667     {
//  668       status = ZMemError;
//  669     }
//  670 
//  671     return status;
//  672 }
//  673 #endif /* MT_NWK_FUNC */
//  674 
//  675 #if defined ( MT_NWK_CB_FUNC )             //NWK callback commands
//  676 /***************************************************************************************************
//  677  * @fn          nwk_MTCallbackSubDataConfirm
//  678  *
//  679  * @brief       Process the callback subscription for NLDE-DATA.confirm
//  680  *
//  681  * @param       nsduHandle  - APS handle
//  682  * @param       Status      - result of data request
//  683  *
//  684  * @return      none
//  685  ***************************************************************************************************/
//  686 void nwk_MTCallbackSubDataConfirm(uint8 nsduHandle, ZStatus_t status)
//  687 {
//  688   uint8 buf[2];
//  689 
//  690   buf[0] = nsduHandle;
//  691   buf[1] = (uint8)status;
//  692 
//  693   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLDE_DATA_CONF, 2, buf );
//  694 }
//  695 
//  696 /***************************************************************************************************
//  697  * @fn          nwk_MTCallbackSubDataIndication
//  698  *
//  699  * @brief       Process the callback subscription for NLDE-DATA.indication
//  700  *
//  701  * @param       SrcAddress      - 16 bit address
//  702  * @param       nsduLength      - Length of incoming data
//  703  * @param       nsdu            - Pointer to incoming data
//  704  * @param       LinkQuality     - Link quality measured during
//  705  *                                reception.
//  706  *
//  707  * @return      none
//  708  ***************************************************************************************************/
//  709 void nwk_MTCallbackSubDataIndication(uint16 SrcAddress, int16 nsduLength, uint8 *nsdu, uint8 LinkQuality)
//  710 {
//  711   uint8 *msgPtr;
//  712   uint8 *msg;
//  713   uint8 msgLen;
//  714 
//  715   msgLen = sizeof( uint16 ) + sizeof( uint8 ) + ZTEST_DEFAULT_DATA_LEN
//  716             + sizeof( uint8);
//  717 
//  718   msgPtr = osal_mem_alloc( msgLen );
//  719   if ( msgPtr )
//  720   {
//  721     //Fill up the data bytes
//  722     msg = msgPtr;
//  723 
//  724     //First fill in details
//  725     *msg++ = LO_UINT16( SrcAddress );
//  726     *msg++ = HI_UINT16( SrcAddress );
//  727 
//  728     //Since the max packet size is less than 255 bytes, a byte is enough
//  729     //to represent nsdu length
//  730     *msg++ = ( uint8 ) nsduLength;
//  731 
//  732     osal_memset( msg, NULL, ZTEST_DEFAULT_DATA_LEN ); // Clear the mem
//  733     osal_memcpy( msg, nsdu, nsduLength );
//  734     msg += ZTEST_DEFAULT_DATA_LEN;
//  735 
//  736     *msg++ = LinkQuality;
//  737 
//  738     MT_BuildAndSendZToolResponse( ((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLDE_DATA_IND, msgLen, msgPtr );
//  739 
//  740     osal_mem_free( msgPtr );
//  741   }
//  742 }
//  743 
//  744 /***************************************************************************************************
//  745  * @fn          nwk_MTCallbackSubInitCoordConfirm
//  746  *
//  747  * @brief       Process the callback subscription for NLME-INIT-COORD.confirm
//  748  *
//  749  * @param       Status - Result of NLME_InitCoordinatorRequest()
//  750  *
//  751  * @return      none
//  752  ***************************************************************************************************/
//  753 void nwk_MTCallbackSubInitCoordConfirm( ZStatus_t Status )
//  754 {
//  755   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_NETWORK_FORMATION_CONF,
//  756                           sizeof(uint8), (uint8*)&Status);
//  757 }
//  758 
//  759 /***************************************************************************************************
//  760  * @fn          nwk_MTCallbackSubStartRouterConfirm
//  761  *
//  762  * @brief       Process the callback subscription for NLME-START-ROUTER.confirm
//  763  *
//  764  * @param       Status - Result of NLME_StartRouterRequest()
//  765  *
//  766  * @return      none
//  767  ***************************************************************************************************/
//  768 void nwk_MTCallbackSubStartRouterConfirm( ZStatus_t Status )
//  769 {
//  770   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_START_ROUTER_CONF,
//  771                           sizeof(uint8), (uint8*)&Status);
//  772 }
//  773 
//  774 /***************************************************************************************************
//  775  * @fn          nwk_MTCallbackSubJoinConfirm
//  776  *
//  777  * @brief       Process the callback subscription for NLME-JOIN.confirm
//  778  *
//  779  * @param       Status - Result of NLME_JoinRequest()
//  780  *
//  781  * @return      none
//  782  ***************************************************************************************************/
//  783 void nwk_MTCallbackSubJoinConfirm(uint16 PanId, ZStatus_t Status)
//  784 {
//  785   uint8 msg[Z_EXTADDR_LEN + 3];
//  786 
//  787   /* This device's 64-bit address */
//  788   ZMacGetReq( ZMacExtAddr, msg );
//  789 
//  790   msg[Z_EXTADDR_LEN + 0] = LO_UINT16(PanId);
//  791   msg[Z_EXTADDR_LEN + 1] = HI_UINT16(PanId);
//  792   msg[Z_EXTADDR_LEN + 2] = (uint8)Status;
//  793 
//  794   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_JOIN_CONF, Z_EXTADDR_LEN + 3, msg );
//  795 }
//  796 /***************************************************************************************************
//  797  * @fn          nwk_MTCallbackSubNetworkDiscoveryConfirm
//  798  *
//  799  * @brief       Process the callback subscription for NLME-NWK_DISC.confirm
//  800  *
//  801  * @param       ResultCount			- number of networks discovered
//  802  * @param				NetworkList			- pointer to list of network descriptors
//  803  *
//  804  * @return      void
//  805  ***************************************************************************************************/
//  806 void nwk_MTCallbackSubNetworkDiscoveryConfirm( uint8 ResultCount, networkDesc_t *NetworkList )
//  807 {
//  808 	uint8 len;
//  809 	uint8 *msgPtr;
//  810 	uint8 *msg;
//  811 	uint8 i;
//  812 
//  813   // The message cannot be bigger then SPI_TX_BUFF_MAX.  Reduce resultCount if necessary
//  814   if (ResultCount * sizeof(networkDesc_t) > MT_UART_TX_BUFF_MAX - (1 + SPI_0DATA_MSG_LEN))
//  815   {
//  816     ResultCount = (MT_UART_TX_BUFF_MAX - (1 + SPI_0DATA_MSG_LEN)) / sizeof(networkDesc_t);
//  817   }
//  818 
//  819 	len = 1 + ResultCount * sizeof(networkDesc_t);
//  820   msgPtr = osal_mem_alloc( len );
//  821 	if ( msgPtr )
//  822 	{
//  823 	  /* Fill up the data bytes */
//  824     msg = msgPtr;
//  825 
//  826 		*msg++ = ResultCount;
//  827 
//  828 		for ( i = 0; i < ResultCount; i++ )
//  829 		{
//  830 		  *msg++ = LO_UINT16( NetworkList->panId );
//  831 		  *msg++ = HI_UINT16( NetworkList->panId );
//  832 		  *msg++ = NetworkList->logicalChannel;
//  833 		  *msg++ = NetworkList->beaconOrder;
//  834 		  *msg++ = NetworkList->superFrameOrder;
//  835 		  *msg++ = NetworkList->routerCapacity;
//  836 		  *msg++ = NetworkList->deviceCapacity;
//  837 		  *msg++ = NetworkList->version;
//  838 		  *msg++ = NetworkList->stackProfile;
//  839 		  //*msg++ = NetworkList->securityLevel;
//  840 		
//  841 			NetworkList = (networkDesc_t*)NetworkList->nextDesc;
//  842 		}
//  843 
//  844     MT_BuildAndSendZToolResponse (((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_NETWORK_DISCOVERY_CONF, len, msgPtr);
//  845 
//  846     osal_mem_free( msgPtr );
//  847 	}
//  848 }
//  849 /***************************************************************************************************
//  850  * @fn          nwk_MTCallbackSubJoinIndication
//  851  *
//  852  * @brief       Process the callback subscription for NLME-INIT-COORD.indication
//  853  *
//  854  * @param       ShortAddress - 16-bit address
//  855  * @param       ExtendedAddress - IEEE (64-bit) address
//  856  * @param       CapabilityInformation - Association Capability Information
//  857  *
//  858  * @return      ZStatus_t
//  859  ***************************************************************************************************/
//  860 void nwk_MTCallbackSubJoinIndication( uint16 ShortAddress, uint8 *ExtendedAddress,
//  861                                       uint8 CapabilityInformation )
//  862 {
//  863   uint8 *msgPtr;
//  864   uint8 *msg;
//  865   uint8 len;
//  866 
//  867   len = sizeof( uint16 ) + Z_EXTADDR_LEN + sizeof( uint8 );
//  868   msgPtr = osal_mem_alloc( len );
//  869 
//  870   if ( msgPtr )
//  871   {
//  872     /* Fill up the data bytes */
//  873     msg = msgPtr;
//  874 
//  875     /* First fill in details */
//  876     *msg++ = LO_UINT16( ShortAddress );
//  877     *msg++ = HI_UINT16( ShortAddress );
//  878 
//  879     osal_cpyExtAddr( msg, ExtendedAddress );
//  880     msg += Z_EXTADDR_LEN;
//  881 
//  882     *msg = CapabilityInformation;
//  883 
//  884     MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_JOIN_IND, len, msgPtr );
//  885 
//  886     osal_mem_free( msgPtr );
//  887   }
//  888 }
//  889 
//  890 /***************************************************************************************************
//  891  * @fn          nwk_MTCallbackSubLeaveConfirm
//  892  *
//  893  * @brief       Process the callback subscription for NLME-LEAVE.confirm
//  894  *
//  895  * @param       DeviceAddress - IEEE (64-bit) address
//  896  * @param       Status - Result of NLME_LeaveRequest()
//  897  *
//  898  * @return      none
//  899  ***************************************************************************************************/
//  900 void nwk_MTCallbackSubLeaveConfirm( uint8 *DeviceAddress, ZStatus_t Status )
//  901 {
//  902   uint8 *msgPtr;
//  903   uint8 *msg;
//  904 
//  905   msgPtr = osal_mem_alloc( Z_EXTADDR_LEN + sizeof( uint8 ) );
//  906   if ( msgPtr )
//  907   {
//  908     /* Fill up the data bytes */
//  909     msg = msgPtr;
//  910 
//  911     /* First fill in details */
//  912     osal_cpyExtAddr( msg, DeviceAddress );
//  913     msg += Z_EXTADDR_LEN;
//  914 
//  915     *msg = (uint8)Status;
//  916 
//  917     MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_LEAVE_CONF,
//  918                             Z_EXTADDR_LEN + sizeof( uint8 ), msgPtr );
//  919 
//  920     osal_mem_free( msgPtr );
//  921   }
//  922 }
//  923 /***************************************************************************************************
//  924  * @fn          nwk_MTCallbackSubLeaveIndication
//  925  *
//  926  * @brief       Process the callback subscription for NLME-LEAVE.indication
//  927  *
//  928  * @param       DeviceAddress - IEEE (64-bit) address
//  929  *
//  930  * @return      NULL
//  931  ***************************************************************************************************/
//  932 void nwk_MTCallbackSubLeaveIndication( uint8 *DeviceAddress )
//  933 {
//  934   uint8 msg[Z_EXTADDR_LEN+1];
//  935 
//  936   /* First fill in details */
//  937   if ( DeviceAddress )
//  938   {
//  939     osal_cpyExtAddr( msg, DeviceAddress );
//  940   }
//  941   else
//  942   {
//  943     osal_memset( msg, 0, Z_EXTADDR_LEN );
//  944   }
//  945 
//  946   /* Status, assume good if we get this far */
//  947   msg[Z_EXTADDR_LEN] = 0;
//  948 
//  949   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_LEAVE_IND, Z_EXTADDR_LEN+1, msg );
//  950 }
//  951 /***************************************************************************************************
//  952  * @fn          nwk_MTCallbackSubSyncIndication
//  953  *
//  954  * @brief       Process the callback subscription for NLME-SYNC.indication
//  955  *
//  956  * @param       none
//  957  *
//  958  * @return      none
//  959  ***************************************************************************************************/
//  960 void nwk_MTCallbackSubSyncIndication( void )
//  961 {
//  962   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_SYNC_IND, 0, NULL );
//  963 }
//  964 
//  965 /***************************************************************************************************
//  966  * @fn          nwk_MTCallbackSubPollConfirm
//  967  *
//  968  * @brief       Process the callback subscription for NLME-POLL.confirm
//  969  *
//  970  * @param       status - status of the poll operation
//  971  *
//  972  * @return      none
//  973  ***************************************************************************************************/
//  974 void nwk_MTCallbackSubPollConfirm( uint8 status )
//  975 {
//  976   uint8 msg = status;
//  977 
//  978   MT_BuildAndSendZToolResponse(((uint8)MT_RPC_CMD_AREQ | (uint8)MT_RPC_SYS_NWK), MT_NLME_POLL_CONF, 1, &msg );
//  979 }
//  980 
//  981 #endif /* NWK Callback commands */
//  982 
//  983 /***************************************************************************************************
//  984  ***************************************************************************************************/
//  985 
// 
// 2 bytes in segment XDATA_Z
// 
// 2 bytes of XDATA memory
//
//Errors: none
//Warnings: none
